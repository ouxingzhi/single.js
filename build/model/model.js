define("model/model",["base/base","base/event","storage/store"],function(require,t,e){function s(){}var i=require("base/base"),r=require("base/event"),a=require("storage/store"),n=0,h=1,u=2,o=r.extend({propertys:function(){this.baseurl=this.buildBaseUrl(),this.url=this.buildUrl(),this.param=this.buildParam(),this.result=this.buildResult(),this.state=n},initialize:function(){},buildBaseUrl:function(){throw"Please override the `buildBaseUrl` method"},buildUrl:function(){throw"Please override the `buildUrl` method"},buildParam:function(){throw"Please override the `buildParam` method"},buildResult:function(){throw"Please override the `buildResult` method"},ajaxRequest:function(){throw"Please override the `ajaxRequest` method"},verifyData:function(t){return!0},getParam:function(){return this.param instanceof a?this.param.get():this.param},setParam:function(t,e){return"object"===i.type(t)?void i.each(t,function(t,e){this.setParam(e,t)},this):void(this.param instanceof a?this.param.setAttr(t,e):(this.param||(this.param={}),this.param[t]=e))},delParam:function(t){return"array"===i.type(t)?void i.each(t,function(t){this.delParam(t)},this):void(this.param instanceof a?this.param.delAttr(t):(this.param||(this.param={}),delete this.param[k]))},getResult:function(){if(this.result instanceof a){var t=this.getParam(),e=t?JSON.stringify(t):null;return this.result.get(e)}return this.result},setResult:function(t){if(this.result instanceof a){var e=this.getParam(),s=e?JSON.stringify(e):null;this.result.set(t,s)}else this.result=t},clearEvents:function(){this.off("success"),this.off("error"),this.off("abort")},request:function(t,e){t=t||{};var i,r=t.success||s,a=t.error||s,o=t.abort||s;if(this.state===u){if(i=this.getResult())return void r.call(e||this,i);this.state=n}if(this.state==u||(this.on("success",r,e),this.on("error",a,e),this.on("abort",o,e),this.state!==h)){var l=this.baseurl.replace(/\/+$/g,"")+"/"+this.url.replace(/^\/+/g,""),c=this.getParam(),f=this;this.ajaxRequest(l,c,function(t){f.verifyData(t)?(f.setResult(t),f.emit("success",t),f.state=u):(f.emit("error",t),f.state=n),f.clearEvents()},function(t){f.emit("error",t),f.state=n,f.clearEvents()}),this.state=h}}});return o});