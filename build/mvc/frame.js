define("SINGLE/mvc/frame.js",["SINGLE/base/base","SINGLE/base/event","SINGLE/base/hash","SINGLE/base/promise","SINGLE/common/funs","SINGLE/common/url.hash","SINGLE/mvc/header","SINGLE/mvc/transition.default","SINGLE/mvc/transition.updown","SINGLE/mvc/transition.notanime","SINGLE/ui/dialog","SINGLE/ui/toast","SINGLE/ui/loading"],function(require,t,i){var e=require("SINGLE/base/base"),a=require("SINGLE/base/event"),s=require("SINGLE/base/hash"),n=require("SINGLE/base/promise"),o=require("SINGLE/common/funs"),h=require("SINGLE/common/url.hash"),r=require("SINGLE/mvc/header"),d=require("SINGLE/mvc/transition.default"),w=require("SINGLE/mvc/transition.updown"),u=require("SINGLE/mvc/transition.notanime"),f=require("SINGLE/ui/dialog"),c=require("SINGLE/ui/toast"),l=require("SINGLE/ui/loading"),v="single-frame-box",m="single-frame-head",V="single-frame-viewport",L="single-frame-foot",p=['<div class="'+v+'">','<div class="'+m+'"></div>','<div class="'+V+'">',"</div>",'<div class="'+L+'"></div>',"</div>"].join(""),S=o.createSingle(c),N=o.createSingle(f),g=o.createSingle(l),b=a.extend({propertys:function(){this.app,this.root=$(p),this.viewhead=this.root.find("."+m),this.viewport=this.root.find("."+V),this.viewfoot=this.root.find("."+L),this.header=new r({box:this.viewhead,frame:this}),this.name,this.views=new s,this.hashdata={},this.viewpath="./src/views",this.framebox,this.defaultView="index",this.transtions={"default":d,updown:w,notanimte:u},this.defaultTranstion="default",this.lastView,this.curView},initialize:function($super,t){$super(),this.setOption(t),this.initDom(),this.app.config.hideHeader&&this.header.hide()},setOption:function(t){e.isNUL(t.app)||(this.app=t.app),e.isNUL(t.name)||(this.name=t.name),e.isNUL(t.viewpath)||(this.viewpath=t.viewpath),e.isNUL(t.framebox)||(this.framebox=t.framebox),e.isNUL(t.defaultView)||(this.defaultView=t.defaultView),e.isNUL(t.transtions)||e.mix(this.transtions,t.transtions),e.isNUL(t.config.defaultTranstion)||(this.defaultTranstion=t.config.defaultTranstion)},getRoot:function(){return this.root},initDom:function(){this.framebox.append(this.root)},hashChange:function(t){t.view||(t=new h(this.defaultView)),this.hashdata=t,this.header.setForward(this.hashdata.forward),this.toView(t.view,t)},toView:function(t,i){var e=this;this.getView(t,i).then(function(t,i,a){e.lastView=e.curView||a,e.curView=a,a.emit("onLoadBefore",e.lastView.hashdata.view),a.onLoad(e.lastView.hashdata.view),a.emit("onLoadAfter",e.lastView.hashdata.view)})},turning:function(t){var i=this.lastView||this.curView;this.curView===this.lastView?(this.curView.getRoot().show(),this.curView.emit("onShowBefore",i.hashdata.view),this.curView.onShow(i.hashdata.view),this.curView.emit("onShowAfter",i.hashdata.view)):this.transferView(t,this.lastView,this.curView,function(){this.lastView.emit("onHideBefore"),this.lastView.onHide(),this.lastView.emit("onHideAfter"),this.curView.emit("onShowBefore",i.hashdata.view),this.curView.onShow(i.hashdata.view),this.curView.emit("onShowAfter",i.hashdata.view)})},getView:function(t,i){var e=this.views.get(t),a=new n;return e?(e.setHashData(i),a.resolve(e)):this.loadView(t,function(e){if(!e)throw new Error("not found `"+t+".js`");var s=new e(t,i,this,this.app);this.viewport.append(s.getRoot()),s.emit("addframe"),this.views.push(t,s),a.resolve(s)}),a},loadView:function(t,i){var e=this.buildFullPath(t),a=this;seajs.use([e],function(t){i.call(a,t)})},getCurrentView:function(){return this.curView||this.lastView},buildFullPath:function(t){return(this.viewpath+"/"+t).replace(/\/+/g,"/")+".js"},transferView:function(t,i,e,a){var s=this.getTransferFn(t);s(i.getRoot(),e.getRoot(),function(){a.call(this)},this)},getTransferFn:function(t){var i;switch(t=t||this.defaultTranstion){case"left":i=d.into;break;case"right":i=d.out;break;case"top":i=w.into;break;case"bottom":i=w.out;break;default:var e=this.transtions[t]||d;i=this.hashdata.forward?e.into:e.out}return i},forward:function(t){var i=h.parse(t);i.frame&&i.frame!==this.name||this.hashChange(i)},back:function(){history.back()},toHead:function(t,i){this.header.to(t,i)},showToast:function(t,i,e){S().show({content:t,timeout:i,callback:e})},hideToast:function(){S().hide()},showAlert:function(t,i,e,a){N().show({title:e||"标题",content:t||"",buttons:i,hideTitle:!a})},hideAlert:function(){N().hide()},showLoading:function(t){g().show({maskOpacity:t})},hideLoading:function(){g().hide()},showHeader:function(){this.header.show()},hideHeader:function(){this.header.hide()}});return b});