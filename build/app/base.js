define("app/base",[],function(require){function e(){var e=document.getElementsByTagName("body");return e&&e[0]}function n(n){var t=document.createElement("iframe");t.src=n,t.style.display="none";var a=e();a&&(a.appendChild(t),setTimeout(function(){a.removeChild(t),t=null},200))}var t="ttpod://",a="js_request",c="app.",r="service",o="params",u="ack",l="callback",f="error",i="cancel",s="confirm",p=function(e){var n=0;return function(){return e+n++}}((new Date).valueOf()+~~(1e8*Math.random())),d=function(){function e(e,n,t){return{fn:e,space:n,onlyone:t}}function d(n,t,a,c,r){switch(a){case l:h[n]=e(t,c,r);break;case f:k[n]=e(t,c,r);break;case i:b[n]=e(t,c,r);break;case s:g[n]=e(t,c,r);break;default:return null}}function m(e){delete e.fn,delete e.space,delete e.onlyone}function y(e){h[e]&&m(h[e]),delete h[e],k[e]&&m(k[e]),delete k[e],b[e]&&m(b[e]),delete b[e],g[e]&&m(g[e]),delete confirm[e]}function v(e,n,m){var y=[];y.push(r+"="+e),n&&y.push(o+"="+encodeURIComponent($.param(n))),m=m||{};var v=p();return"function"==typeof m.callback&&(d(v,m.callback,l,m.space,m.onlyone),y.push(l+"="+c+l)),"function"==typeof m.error&&(d(v,m.error,f,m.space,m.onlyone),y.push(f+"="+c+f)),"function"==typeof m.cancel&&(d(v,m.cancel,i,m.space,m.onlyone),y.push(i+"="+c+i)),"function"==typeof m.confirm&&(d(v,m.confirm,s,m.space,m.onlyone),y.push(s+"="+c+s)),y.push(u+"="+v),{url:t+a+"?"+y.join("&"),ack:v}}var h={},k={},b={},g={},w=function(e,n,t){var a=e[n];t=[].slice.call(t,1),a&&(a.fn.apply(a.space||this,t),a.onlyone&&(delete e[n],a.fn=a.space=null))},C={};return C[l]=function(e){w(h,e,arguments)},C[f]=function(e){w(k,e,arguments)},C[i]=function(e){w(b,e,arguments)},C[s]=function(e){w(g,e,arguments)},window.app=C,{create:function(e,n,t){var a=p();return d(a,e,l,n,t),a},call:function(e,t){t=t||{};var a=v(e,t.params,t);return n(a.url),a.ack},del:function(e){y(e)}}}();return d});