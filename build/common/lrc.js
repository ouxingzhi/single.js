define("SINGLE/common/lrc.js",["base/event"],function(require){function t(t){var e=t.split(/[:\.]/);return 60*parseInt(e[0].replace(u,"$1"))+parseInt(e[1].replace(u,"$1"))+parseInt((e[2]||"0").replace(u,"$1"))/1e3}function e(e){var r=[];return e.replace(a,function(e,n){r.push(t(n))}),r}function r(t){t=t||"";for(var r,n,a,u=t.split(i),o=[],f={},p=0,h=u.length;h>p;p++)if(u[p]=u[p].replace(c,""),a=u[p].match(s))f[a[1]]=a[2]||"";else if(a=u[p].match(l)){r=e(a[1]),n=u[p].replace(l,"");for(var d=0,m=r.length;m>d;d++)o.push({time:r[d],line:n,id:+new Date+String(Math.random()).replace(".","")})}return o.sort(function(t,e){return t.time-e.time}),{meta:f,lines:o}}var n=require("base/event"),i=/[\r\n]+/,s=/^\[(ti|ar|al|by|offset):([^\[\]]*)\]$/,c=/^\s+|\s+$/,l=/((?:\[\d{1,2}:\d{1,2}(?:[:\.]\d{1,3}?)\])(?:\s*\[\d{1,2}:\d{1,2}(?:[:\.]\d{1,3}?)\])*)/,a=/\[(\d{1,2}:\d{1,2}(?:[:\.]\d{1,3}?))\]/g,u=/^0+([0-9]+)$/,o=n.extend({propertys:function(){this.lrc="",this.lrcObj},initialize:function(t){this._setOption(t)},_setOption:function(t){t.lrc&&this.setLrc(t.lrc)},setLrc:function(t){this.lrcObj=r(t),this.emit("update",[this.lrcObj])},getLrc:function(){return this.lrcObj},pos:function(t){if(!this.lrcObj||!this.lrcObj.lines)return null;for(var e,r,n=this.lrcObj.lines,i={},s=0,c=n.length;c>s;s++)if(e=n[s],r=n[s+1]||i,e.time<=t&&(r===i||r.time>t)||0==s&&e.time>=t)return e;return null}});return o.parse=r,o});