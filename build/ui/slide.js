define("ui/slide.js",["ui/object","base/base","common/funs"],function(require){function t(t){var i=$(r);return i.append(t),i}function i(){this.items&&h.each(this.items,function(t){this.add(t)},this),this.subbox=this.$el.find("."+d)}function s(){var t=this.$el.width(),i=this.$el.find("."+o),s=i.length*t;this.$el.find("."+d).css("width",s+"px"),i.width(t)}function e(){this.$el[0].addEventListener("touchstart",this,!1),this.$el[0].addEventListener("touchmove",this,!1),this.$el[0].addEventListener("touchend",this,!1)}var n=require("ui/object"),h=require("base/base"),a=(require("common/funs"),"ui-slide-box"),d="ui-slide-sub-box",o="ui-slide-item",c="ui-slide-trans",l="ui-slide-nav",u="ui-slide-cur-nav",r='<div class="'+o+'"></div>';return n.extend({propertys:function(){this.on("create",function(){this.$el.addClass(a),i.call(this),e.call(this),this.to(this.index)}),this.length=0,this.on("sizechange",function(){this.length=this.$el.find("."+o).length}),this.on("show",s),this.items=[],this.index=0},createHTML:function(){return['<div class="'+d+'"></div>','<div class="'+l+'"></div>'].join("")},initialize:function($super,t){$super(t)},setOption:function($super,t){t=t||{},$super(t),t.items&&(this.items=t.items),t.index&&(this.index=t.index)},tx:0,dx:0,handleEvent:function(t){var i,s=t.changedTouches[0];switch(t.type){case"touchstart":this.subbox.removeClass(c),this.tx=s.pageX,this.dx=parseInt(this.subbox.css("left")||0);break;case"touchmove":i=s.pageX-this.tx,this.subbox.css("left",this.dx+i+"px");break;case"touchend":case"touchcancel":if(i=s.pageX-this.tx,this.subbox.addClass(c),this.subbox.css("left",this.dx+"px"),Math.abs(i)<20)return;i>0?this.pre():this.next()}},add:function(i,s){if(this.$el){var i=t.call(this,i);"number"==typeof s&&s!=0/0?0>s?this.$el.find("."+o).eq(0).before(i):this.$el.find("."+o).eq(s).after(i):this.$el.find("."+d).append(i);var e=this.createDomId();i.attr("id",e);var n=this.$el.find("."+l),h=$("<span></span>");h.attr("id","from-"+e),n.append(h),this.emit("sizechange")}},remove:function(t){if(this.$el){var i=this.$el.find("."+o).eq(t);i.length&&(i.remove(),this.emit("sizechange"))}},to:function(t){var i=0;t>=this.length&&(t=Math.max(this.length-1,0)),0>t&&(t=0),i=-(this.$el.width()*t),this.$el.find("."+d).css("left",i+"px");var s=this.$el.find("."+l).find("span").eq(t);s.addClass(u),s.siblings().removeClass(u),this.index=t},pre:function(){this.to(this.index-1)},next:function(){this.to(this.index+1)}})});